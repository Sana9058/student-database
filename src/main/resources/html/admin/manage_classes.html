%[site;title=Klassen verwalten;content=!FOLLOWS]
<section id="classes">
    <header>
        <h1>Klassen verwalten</h1>
    </header>
    <main>
        <section id="addClass">
            <h2>Klasse hinzuf端gen</h2>
            <form id="addClassForm" method="post" action="/add-class">
                <label for="className">Name der Klasse:</label>
                <input type="text" id="className" name="className" required>
                <label for="grade">Stufe:</label>
                <input type="number" id="grade" name="grade" required>
                <button type="submit">Hinzuf端gen</button>
            </form>
        </section>
        <section id="classList">
            <h2>Klassen端bersicht</h2>
            <table id="classTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Stufe</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <!-- class rows will be inserted here -->
                </tbody>
            </table>
        </section>
    </main>
    <nav>
        <a href="/dashboard"><button>Zur端ck zum Admin-Dashboard</button></a>
    </nav>
</section>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        loadClasses();
    });

    async function loadClasses() {
        populateTable("/classes", "classTable", (newRow, cls) => {
            newRow.innerHTML = `
                <td>${cls.id}</td>
                <td>${cls.label}</td>
                <td>${cls.grade}</td>
                <td><button class="edit" onclick='editClass(${JSON.stringify(cls).replaceAll('"',"'")})'>Bearbeiten</button></td>
            `;
        });
    }
    function editClass(cls) {
        sessionStorage.setItem('currentClass', JSON.stringify(cls));
        window.location.href = '/class';
    }
</script>