%[site;title=Lehrer verwalten;content=!FOLLOWS]
<section id="teachers">
    <header>
        <h1>Lehrer verwalten</h1>
    </header>
    <main>
        <section id="add-teacher">
            <h2>Lehrer hinzufügen</h2>
            <form id="add-teacher-form" method="POST" action="/add-teacher">
                <label for="teacher-first-name">Vorname:</label>
                <input type="text" id="teacher-first-name" name="firstName" required>
                <label for="teacher-last-name">Nachname:</label>
                <input type="text" id="teacher-last-name" name="lastName" required>
                <label for="teacher-email">Email:</label>
                <input type="email" id="teacher-email" name="email" required>
                <button type="submit">Lehrer hinzufügen</button>
            </form>
        </section>
        <section id="add-teachers-csv">
            <h2>Lehrer aus CSV hinzufügen</h2>
            <form id="add-teachers-csv-form" method="post" action="/add-teachers">
                <label for="csv-input">CSV-Datei:</label>
                <textarea id="csv-input" name="csv" rows="10" cols="50" placeholder="Vorname,Nachname,Email"></textarea>
                <button type="submit">Lehrer hinzufügen</button>
            </form>
        </section>
        <section id="teacher-list">
            <h2>Lehrer-Liste</h2>
            <a href="/teachers" download="lehrer.json"><button id="download-teachers">Lehrer herunterladen</button></a>
            <table id="teacherTable">
                <thead>
                    <tr>
                        <th>Vorname</th>
                        <th>Nachname</th>
                        <th>Email</th>
                        <th>Aktionen</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Teacher rows will be dynamically inserted here -->
                </tbody>
            </table>
        </section>
    </main>
    <nav>
        <a href="/dashboard"><button>Zurück zum Admin-Dashboard</button></a>
    </nav>
</section>
<script>
    document.getElementById('add-teachers-csv-form').addEventListener('submit', async function(e) {
        e.preventDefault();
        const form = e.target;
        const csv = form['csv'].value;
        postDataAndDownload('/add-teachers', csv, 'lehrer.csv');
    });
    document.addEventListener('DOMContentLoaded', async function() {
        populateTable('/teachers', 'teacherTable', (newRow, teacher) => {
            newRow.innerHTML = `
                <td>${teacher.firstName}</td>
                <td>${teacher.lastName}</td>
                <td>${teacher.email}</td>
                <td>
                    <button class="view-teacher" onclick="viewTeacher(${JSON.stringify(teacher).replaceAll('"', "'")})">Ansehen</button>
                </td>
            `;
        });
    });
</script>